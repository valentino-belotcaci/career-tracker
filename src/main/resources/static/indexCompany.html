<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	<title>Company Dashboard</title>
</head>
<body>
<header>
	<a class="site-title" href="/indexCompany.html">CareerTracker</a>
</header>

<main class="wide-card">
	<h2>Company Dashboard</h2>
	<p>Welcome, company. Use the navigation to manage your company profile.</p>

	<div class="spaced">
		<a href="/profileCompany.html"><button class="btn">View profile</button></a>
	</div>

	<div class="spaced">
		<a href="/displayJobPost.html"><button class="btn">Job Posts</button></a>
	</div>

  <div class="spaced">
    	<button id="logoutBtn" class="btn">Logout</button>
  </div>
</main>

<footer>
	<p>Â© 2026 CareerTracker</p>
</footer>

<script>
/* ================= LOGOUT ================= */
document.getElementById('logoutBtn').addEventListener('click', async function () {
  try {
    // Call backend logout endpoint to clear HttpOnly cookie
    await fetch('/Account/logout', {
      method: 'POST',
      credentials: 'include' // send cookies
    });
  } catch (err) {
    console.warn('Logout request failed, still redirecting.');
  } finally {
    // Clear any client-side state just in case
    localStorage.removeItem('loggedId');
    localStorage.removeItem('type');
    window.location.href = '/login.html';
  }
});

/* ================= AUTH FETCH HELPER ================= */
// all fetch requests automatically include cookies
window.authFetch = function(url, opts = {}) {
  opts = opts || {};
  opts.credentials = 'include'; // important: send HttpOnly cookies
  opts.headers = opts.headers || {};
  return fetch(url, opts);
};

/* ================= CHECK AUTH ================= */
/*
(async function checkAuth() {
  try {
    const res = await authFetch('/Account/'); // optional endpoint to verify login
    if (res.status === 401 || res.status === 403) {
      window.location.href = '/login.html';
    }
  } catch (err) {
    console.warn('Auth check failed, redirecting to login');
    window.location.href = '/login.html';
  }
} 
)();*/
</script>
</body>
</html>
