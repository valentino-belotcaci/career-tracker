<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="stylesheet" href="/css/style.css">
	<title>User Dashboard</title>
</head>
<body>
<header>
	<a class="site-title" href="/indexUser.html">CareerTracker</a>
</header>
<main class="wide-card">
	<h2>User Dashboard</h2>
	<p>Welcome, user. Use the navigation to manage your data.</p>

	<div style="margin-top:1rem;">
		<a href="/profileUser.html"><button>View profile</button></a>
	</div>

	<div style="margin-top:1rem;">
		<a href="/displayJobApplication.html"><button>Job Applications</button></a>
	</div>

	<div style="margin-top:1rem;">
		<button id="logoutBtn">Logout</button>
	</div>

	<script>
	document.getElementById('logoutBtn').addEventListener('click', function(){
		// Clear all localStorage entries to fully sign out the client
		localStorage.clear();
		globalThis.location.href = '/index.html';
	});
	</script>
</main>
<footer>
	<p>Â© 2026 CareerTracker</p>
</footer>
<script>
(function () {
  // Read token saved at login
  const token = localStorage.getItem('jwt');

  // If no token, send user back to login
  if (!token) {
    console.warn('No JWT found, redirecting to login');
    window.location.href = '/login.html';
    return;
  }

  // Expose token for debugging if needed
  window.jwt = token;

  // Helper to call protected endpoints with Authorization header
  window.authFetch = function (url, opts = {}) {
    opts.headers = opts.headers || {};
    // preserve existing headers and add Authorization
    opts.headers = Object.assign({}, opts.headers, {
      'Authorization': 'Bearer ' + token
    });
    return fetch(url, opts);
  };

  // Example usage:
  // authFetch('/User/getProfile/' + localStorage.getItem('loggenId'))
  //   .then(r => r.json()).then(console.log).catch(console.error);
})();
</script>
</body>
</html>
